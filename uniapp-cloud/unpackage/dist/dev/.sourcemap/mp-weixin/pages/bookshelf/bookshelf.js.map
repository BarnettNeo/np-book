{"version":3,"sources":["uni-app:///main.js","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?16ea","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?3036","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?95c1","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?03f9","uni-app:///pages/bookshelf/bookshelf.vue","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?b1a3","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?5723"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"pages/bookshelf/bookshelf.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/bookshelf/bookshelf.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./bookshelf.vue?vue&type=template&id=59858e6c&\"\nvar renderjs\nimport script from \"./bookshelf.vue?vue&type=script&lang=js&\"\nexport * from \"./bookshelf.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bookshelf.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/bookshelf/bookshelf.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=template&id=59858e6c&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.showShareMenu = true\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=script&lang=js&\"","<template>\n\t<pubpage :title=\"shelfInfo.name\">\n\t\t<view slot=\"contentSection\" style=\"height: 100%;\">\n\t\t\t<canvas id=\"myPoster\" canvas-id=\"myPoster\" type=\"2d\" style=\"position: absolute;left:-350px;width:350px;height:750px;\"></canvas>\n\t\t\t<pubshare v-if=\"showShareMenu\" @selected=\"onShareSelected\" @dismiss=\"onShareDismiss\"></pubshare>\n\t\t\t<view style=\"justify-content: start;display: flex;flex-wrap: wrap;padding-bottom: 70px;\">\n\t\t\t\t<view v-for=\"item in books\" style=\"width:33.3%;padding:10px;margin-bottom: 10px;\">\n\t\t\t\t\t<bookcell :data=\"item\"></bookcell>\n\t\t\t\t\t<view v-if=\"isEditing\" @click=\"btnDeleteBook\" :data-id=\"item._id\" style='font-size:10px;text-align:center;margin-top: 10px;'><text style=\"padding:5px 10px;background:#f3433e;color:#fff;border-radius:5px;\">编辑</text></view>\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"isBooksLen\" style=\"position: absolute;width: 100%;text-align: center;top: 25%;\">没图书了哥</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<view v-if=\"shelfInfo.isowner\" slot=\"tabSection\" style=\"padding:10px;\">\n\t\t\t<view v-if=\"!isEditing\" style=\"background-color: #00aaff;width: 100%;height: 50px;border-radius: 25px;display: flex;line-height: 50px;color:#fff;justify-content: space-between;\">\n\t\t\t\t<view @click=\"showShareMenu= true\" class=\"iconfont icon-share\" style=\"width:50px;height: 50px;text-align: center;\"></view>\n\t\t\t\t<view @click=\"btnScan\" style=\"flex:1;text-align: center;\">添加图书</view>\n\t\t\t\t<view @click=\"btnEnterEditing\" class=\"iconfont icon-apps\" style=\"width:50px;height: 50px;text-align: center;\"></view>\n\t\t\t</view>\n\t\t\t<view v-else style=\"background-color: #00aaff;width: 100%;height: 50px;border-radius: 25px;display: flex;line-height: 50px;color:#fff;justify-content: space-between;\">\n\t\t\t\t<view></view>\n\t\t\t\t<view @click=\"btnExitEditing\" style=\"flex:1;text-align: center;\">退出编辑模式</view>\n\t\t\t\t<view></view>\n\t\t\t</view>\n\t\t</view>\n\t</pubpage>\n</template>\n\n<script>\n\timport cloudApi from \"../../common/cloudApi.js\"\n\timport pubpage from \"../../components/pubpage.vue\"\n\timport pubshare from \"../../components/pubshare.vue\"\n\t\n\timport bookcell from \"../../components/pub-ui/bookcell.vue\"\n\t\n\texport default {\n\t\tcomponents:{\n\t\t\tpubpage,\n\t\t\tbookcell,\n\t\t\tpubshare\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\ttitle:\"\",\n\t\t\t\tisEditing:false,\n\t\t\t\tshelfInfo:null,\n\t\t\t\tshelfid:null,\n\t\t\t\tcanloadmore:true,\n\t\t\t\tshowShareMenu:false,\r\n\t\t\t\tisBooksLen:false,\n\t\t\t\tbooks:[]\n\t\t\t}\n\t\t},\n\t\tonLoad(options) {\n\t\t\tthis.shelfid = options.id;\n\t\t\tif(!this.shelfid)uni.navigateBack();\n\t\t\t\n\t\t\tthis.getShelfInfo();\n\t\t\tthis.requestBookList();\n\t\t},\n\t\tonReachBottom() {\n\t\t\tthis.requestBookList(this.books[this.books.length-1]._id);\n\t\t},\n\t\tonShareAppMessage() {\n\t\t\treturn {\n\t\t\t\ttitle: this.title,\n\t\t\t\tpath: '/pages/me/index?scene=sid='+this.shelfInfo._id\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\tdrawPoster(){\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle:\"生成中\",\n\t\t\t\t\tmask:true\n\t\t\t\t});\n\t\t\t\tconst query = wx.createSelectorQuery()\n\t\t\t\tquery.select('#myPoster')\n\t\t\t\t\t .fields({ node: true, size: true })\n\t\t\t\t\t .exec(async (res) => {\n\t\t\t\t\t\tvar canvas = res[0].node\n\t\t\t\t\t\tvar ctx = canvas.getContext('2d')\n\t\t\t\t\n\t\t\t\t\t\tconst dpr = uni.getSystemInfoSync().pixelRatio\n\t\t\t\t\t\tcanvas.width = res[0].width * dpr\n\t\t\t\t\t\tcanvas.height = res[0].height * dpr\n\t\t\t\t\t\tctx.scale(dpr, dpr)\n\t\t\t\t\n\t\t\t\t\t\tctx.fillStyle = \"#ffffff\";\n\t\t\t\t\t\tctx.fillRect(0,30,350,750);\n\t\t\t\t\t\t\n\t\t\t\t\t\t//ownerInfo\n\t\t\t\t\t\tctx.fillStyle='black';\n\t\t\t\t\t\tctx.fontSize=20;\r\n\t\t\t\t\t\t// console.log(this.shelfInfo.name)\r\n\t\t\t\t\t\tctx.fillText(\"用户名：\" + this.shelfInfo.ownerinfo.nickName, 70, 50);\n\t\t\t\t\t\t\n\t\t\t\t\t\tctx.fontSize=20\r\n\t\t\t\t\t\tctx.fillText(\"书房名：\" + this.shelfInfo.name, 70, 65);\n\t\t\t\t\t\t\n\t\t\t\t\t\tctx.fontSize=20\n\t\t\t\t\t\tctx.fillText(\"地址：\" + this.shelfInfo.address, 70, 80);\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar image=canvas.createImage();\n\t\t\t\t\t\timage.onload=(res)=>{\n\t\t\t\t\t\t  ctx.drawImage(image, 10, 35,50,50);\n\t\t\t\t\t\t}\n\t\t\t\t\t\timage.src=this.shelfInfo.ownerinfo.avatarUrl;\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t//books\n\t\t\t\t\t\tvar bookLength = Math.min(this.books.length,9);\n\t\t\t\t\t\tvar bookIndex = 0;\n\t\t\t\t\t\tvar loadNextBookCover=()=>{\n\t\t\t\t\t\t\tvar bookItem = this.books[bookIndex];\r\n\t\t\t\t\t\t\tconsole.log(this.books)\r\n\t\t\t\t\t\t\tif(this.books.length<1){\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\tcontent: '无图书分享',\r\n\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tuni.getImageInfo({\n\t\t\t\t\t\t\t\tsrc:bookItem.cover_url,\n\t\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\t\tvar image = canvas.createImage();\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\timage.onload=()=>{\n\t\t\t\t\t\t\t\t\t\tvar dx = Math.floor(bookIndex % 3) * (100+15)+10;\n\t\t\t\t\t\t\t\t\t\tvar dy = Math.floor(bookIndex / 3) * (150+15)+100;\n\t\t\t\t\t\t\t\t\t\tctx.drawImage(image, dx, dy,100,150);\r\n\t\t\t\t\t\t\t\t\t\t// 书名\r\n\t\t\t\t\t\t\t\t\t\tctx.fontSize=16\r\n\t\t\t\t\t\t\t\t\t\tctx.fillText(bookItem.title, dx+5, dy+165);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(bookIndex<bookLength-1){\n\t\t\t\t\t\t\t\t\t\t  bookIndex++;\n\t\t\t\t\t\t\t\t\t\t  loadNextBookCover();\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t  console.log(\"全部封面加载结束\");\n\t\t\t\t\t\t\t\t\t\t  uni.hideLoading();\n\t\t\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t\t\t\t  uni.canvasToTempFilePath({\n\t\t\t\t\t\t\t\t\t\t\t  canvas:canvas,\n\t\t\t\t\t\t\t\t\t\t\t  success: (res) => {\n\t\t\t\t\t\t\t\t\t\t\t  \tuni.previewImage({\n\t\t\t\t\t\t\t\t\t\t\t  \t\tcurrent:res.tempFilePath,\n\t\t\t\t\t\t\t\t\t\t\t\t\turls:[res.tempFilePath]\n\t\t\t\t\t\t\t\t\t\t\t  \t})\n\t\t\t\t\t\t\t\t\t\t\t  },\n\t\t\t\t\t\t\t\t\t\t\t  fail: (err) => {\n\t\t\t\t\t\t\t\t\t\t\t  \tconsole.log(err);\n\t\t\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t\t  })\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\timage.src=res.path;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//wxacode\n\t\t\t\t\t\tconst wxacodeRes = await cloudApi.call({\n\t\t\t\t\t\t\tname:\"getwxacode\",\n\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\tscene:\"sid=\"+this.shelfInfo._id\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconsole.log(wxacodeRes)\n\t\t\t\t\t\t\n\t\t\t\t\t\twx.getFileSystemManager().writeFileSync(\n\t\t\t\t\t\t\t`${wx.env.USER_DATA_PATH}/mpcode.jpg`,\n\t\t\t\t\t\t\tuni.arrayBufferToBase64(wxacodeRes.result.data),\n\t\t\t\t\t\t\t\"base64\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tuni.getImageInfo({\n\t\t\t\t\t\t\tsrc:`${wx.env.USER_DATA_PATH}/mpcode.jpg`,\n\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\tvar image=canvas.createImage();\n\t\t\t\t\t\t\t\timage.onload=(res)=>{\t\t\t\n\t\t\t\t\t\t\t\t  ctx.drawImage(image, 350-170, 750-170,160,160);\n\t\t\t\t\t\t\t\t  loadNextBookCover();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\timage.src=res.path;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t})\n\t\t\t},\n\t\t\tonShareSelected(index){\n\t\t\t\tif(index==1){\n\t\t\t\t\tthis.drawPoster();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonShareDismiss(){\n\t\t\t\tthis.showShareMenu= false;\n\t\t\t},\n\t\t\tgetShelfInfo() {\n\t\t\t\tcloudApi.call({\n\t\t\t\t\tname:\"bookshelfs\",\n\t\t\t\t\tdata:{\n\t\t\t\t\t\taction:\"get\",\n\t\t\t\t\t\t_id:this.shelfid\n\t\t\t\t\t},\n\t\t\t\t\tsuccess:(res)=>{\n\t\t\t\t\t\tconsole.log(res.result);\n\t\t\t\t\t\tthis.shelfInfo = res.result;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\trequestBookList(start=0){\n\t\t\t\tif(start&&!this.canloadmore)return;\n\t\t\t\tcloudApi.call({\n\t\t\t\t\tname:\"books\",\n\t\t\t\t\tdata:{\n\t\t\t\t\t\taction:\"listbyshelf\",\n\t\t\t\t\t\tshelfid:this.shelfid,\n\t\t\t\t\t\tstart:start\n\t\t\t\t\t},\n\t\t\t\t\tsuccess:(res)=>{\n\t\t\t\t\t\tthis.canloadmore = res.result.length>=9;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(!start)this.books = res.result;\n\t\t\t\t\t\telse this.books = this.books.concat(res.result);\r\n\t\t\t\t\t\tif(this.books<1) this.isBooksLen = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tbtnDeleteBook(e){\n\t\t\t\tconsole.log(e.currentTarget.dataset.id);\n\t\t\t\tuni.showActionSheet({\n\t\t\t\t\titemList:[\"置顶\",\"删除\"],\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif(res.tapIndex==0){\n\t\t\t\t\t\t\tcloudApi.call({\n\t\t\t\t\t\t\t\tname:\"books\",\n\t\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\t\taction:\"movetop\",\n\t\t\t\t\t\t\t\t\tbookid:e.currentTarget.dataset.id\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsuccess:(res)=>{\n\t\t\t\t\t\t\t\t\tthis.requestBookList();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}else if(res.tapIndex==1){\n\t\t\t\t\t\t\tcloudApi.call({\n\t\t\t\t\t\t\t\tname:\"books\",\n\t\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\t\taction:\"delete\",\n\t\t\t\t\t\t\t\t\tshelfid:this.shelfid,\n\t\t\t\t\t\t\t\t\tbookid:e.currentTarget.dataset.id\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsuccess:(res)=>{\n\t\t\t\t\t\t\t\t\tthis.requestBookList();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tbtnExitEditing(){\n\t\t\t\tthis.isEditing = false;\n\t\t\t},\n\t\t\tbtnEnterEditing(){\n\t\t\t\tthis.isEditing = true;\n\t\t\t},\n\t\t\tbtnScan(){\n\t\t\t\tuni.scanCode({\n\t\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\t\tconst isbnres = await cloudApi.call({\n\t\t\t\t\t\t\tname:\"ISBNQuery\",\n\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\tisbn:res.result\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\tawait cloudApi.call({\n\t\t\t\t\t\t\tname:\"books\",\n\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\taction:\"add\",\n\t\t\t\t\t\t\t\tshelfid:this.shelfid,\n\t\t\t\t\t\t\t\tisbnid:isbnres.result._id,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.requestBookList();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\tpage\n\t{\n\t\tbackground-color: #fff;\n\t}\n</style>\n","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1653584258301\n      var cssReload = require(\"E:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}