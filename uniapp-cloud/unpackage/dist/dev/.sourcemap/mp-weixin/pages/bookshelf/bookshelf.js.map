{"version":3,"sources":["uni-app:///main.js",null,"webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?3036","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?95c1","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?03f9","uni-app:///pages/bookshelf/bookshelf.vue","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?8658","webpack:///D:/github-me/uniapp-project/uniapp-cloud/pages/bookshelf/bookshelf.vue?9214"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,wG,6FAFmBA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC;AAGnBC,UAAU,CAACC,kBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsH;AACtH;AAC6D;AACL;AACc;;;AAGtE;AACgL;AAChL,gBAAgB,yLAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,oFAAM;AACR,EAAE,6FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,wFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACbA;AAAA;AAAA;AAAA;AAA0pB,CAAgB,+qBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACsC9qB,gG;;;;;;AAMA;AACA;AACA,oBADA;AAEA,sBAFA;AAGA,sBAHA,EADA;;AAMA,MANA,kBAMA;AACA;AACA,eADA;AAEA,sBAFA;AAGA,qBAHA;AAIA,mBAJA;AAKA,uBALA;AAMA,0BANA;AAOA,uBAPA;AAQA,eARA;;AAUA,GAjBA;AAkBA,QAlBA,kBAkBA,OAlBA,EAkBA;AACA;AACA;;AAEA;AACA;AACA,GAxBA;AAyBA,eAzBA,2BAyBA;AACA;AACA,GA3BA;AA4BA,mBA5BA,+BA4BA;AACA;AACA,uBADA;AAEA,6DAFA;;AAIA,GAjCA;AAkCA;AACA,cADA,wBACA;AACA;AACA,oBADA;AAEA,kBAFA;;AAIA;AACA;AACA,YADA,CACA,0BADA;AAEA,UAFA,iGAEA;AACA,wBADA,GACA,WADA;AAEA,qBAFA,GAEA,uBAFA;;AAIA,qBAJA,GAIA,kCAJA;AAKA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,uBAxBA,GAwBA,oBAxBA;AAyBA;AACA;AACA,mBAFA;AAGA;;;AAGA;AACA,4BAhCA,GAgCA,+BAhCA;AAiCA,2BAjCA,GAiCA,CAjCA;AAkCA,mCAlCA,GAkCA;AACA;AACA;AACA;AACA;AACA,wCADA;AAEA,yCAFA;;AAIA;AACA;;AAEA;AACA,6CADA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAHA,MAGA;AACA;AACA;;AAEA;AACA,4CADA;AAEA;AACA;AACA,2DADA;AAEA,0DAFA;;AAIA,+BAPA;AAQA;AACA;AACA,+BAVA;;AAYA;AACA,yBA5BA;AA6BA;AACA,uBAnCA;;AAqCA,mBAlFA;;AAoFA;AApFA,4CAqFA;AACA,sCADA;AAEA;AACA,yDADA,EAFA,GArFA,SAqFA,UArFA;;;AA2FA;;AAEA;AACA,uCADA;AAEA,iEAFA;AAGA,0BAHA;;AAKA;AACA,wEADA;AAEA;AACA;AACA;AACA;AACA;AACA,uBAHA;AAIA;AACA,qBATA,IAlGA,yDAFA;;;;;;AAmHA,KA1HA;AA2HA,mBA3HA,2BA2HA,KA3HA,EA2HA;AACA;AACA;AACA;AACA,KA/HA;AAgIA,kBAhIA,4BAgIA;AACA;AACA,KAlIA;AAmIA,gBAnIA,0BAmIA;AACA;AACA,0BADA;AAEA;AACA,uBADA;AAEA,2BAFA,EAFA;;AAMA;AACA;AACA;AACA,SATA;;AAWA,KA/IA;AAgJA,mBAhJA,6BAgJA;AACA;AACA;AACA,qBADA;AAEA;AACA,+BADA;AAEA,+BAFA;AAGA,sBAHA,EAFA;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA;AACA,SAjBA;;AAmBA,KArKA;AAsKA,iBAtKA,yBAsKA,CAtKA,EAsKA;AACA;AACA;AACA,8BADA;AAEA;AACA;AACA;AACA,2BADA;AAEA;AACA,iCADA;AAEA,kDAFA,EAFA;;AAMA;AACA;AACA,eARA;;AAUA,WAXA,MAWA;AACA;AACA,2BADA;AAEA;AACA,gCADA;AAEA,uCAFA;AAGA,kDAHA,EAFA;;AAOA;AACA;AACA,eATA;;AAWA;AACA,SA3BA;;AA6BA,KArMA;AAsMA,kBAtMA,4BAsMA;AACA;AACA,KAxMA;AAyMA,mBAzMA,6BAyMA;AACA;AACA,KA3MA;AA4MA,WA5MA,qBA4MA;AACA;AACA;;AAEA;AACA,yCADA;AAEA;AACA,0CADA,EAFA,GAFA,SAEA,OAFA;;;AAQA;AACA,qCADA;AAEA;AACA,uCADA;AAEA,iDAFA;AAGA,oDAHA,EAFA,GARA;;;;AAiBA,6CAjBA,8IADA;;;AAqBA;AACA;AACA;AACA,iCADA;AAEA,6BAFA;;AAIA,SA3BA;;AA6BA,KA1OA,EAlCA,E;;;;;;;;;;;;;AC5CA;AAAA;AAAA;AAAA;AAAivC,CAAgB,8sCAAG,EAAC,C;;;;;;;;;;;ACArwC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/bookshelf/bookshelf.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/bookshelf/bookshelf.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./bookshelf.vue?vue&type=template&id=59858e6c&\"\nvar renderjs\nimport script from \"./bookshelf.vue?vue&type=script&lang=js&\"\nexport * from \"./bookshelf.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bookshelf.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/bookshelf/bookshelf.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=template&id=59858e6c&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.showShareMenu = true\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=script&lang=js&\"","<template>\r\n\t<pubpage :title=\"shelfInfo.name\">\r\n\t\t<view slot=\"contentSection\" style=\"height: 100%;\">\r\n\t\t\t<canvas id=\"myPoster\" canvas-id=\"myPoster\" type=\"2d\" style=\"position: absolute;left:-350px;width:350px;height:750px;\"></canvas>\r\n\t\t\t<pubshare v-if=\"showShareMenu\" @selected=\"onShareSelected\" @dismiss=\"onShareDismiss\"></pubshare>\r\n\t\t\t<view class=\"User_info\">\r\n\t\t\t\t<view class=\"User_avatarUrl\">\r\n\t\t\t\t\t<image :src=\"shelfInfo.ownerinfo.avatarUrl\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"User_text\">\r\n\t\t\t\t\t<text class=\"nickName\">用户：{{shelfInfo.ownerinfo.nickName}}</text>\r\n\t\t\t\t\t<text class=\"address\">地址：{{shelfInfo.address}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"justify-content: start;display: flex;flex-wrap: wrap;padding-bottom: 70px;\">\r\n\t\t\t\t<view v-for=\"item in books\" :key=\"item._id\" style=\"width:33.3%;padding:10px;margin-bottom: 10px;\">\r\n\t\t\t\t\t<bookcell :data=\"item\"></bookcell>\r\n\t\t\t\t\t<view v-if=\"isEditing\" @click=\"btnDeleteBook\" :data-id=\"item._id\" style='font-size:10px;text-align:center;margin-top: 10px;'><text style=\"padding:5px 10px;background:#f3433e;color:#fff;border-radius:5px;\">编辑</text></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"isBooksLen\" ref=\"BooksLen\" style=\"position: absolute;width: 100%;text-align: center;top: 25%;\">没图书了</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view v-if=\"shelfInfo.isowner\" slot=\"tabSection\" style=\"padding:10px;\">\r\n\t\t\t<view v-if=\"!isEditing\" style=\"background-color: #00aaff;width: 100%;height: 50px;border-radius: 25px;display: flex;line-height: 50px;color:#fff;justify-content: space-between;\">\r\n\t\t\t\t<view @click=\"showShareMenu= true\" class=\"iconfont icon-share\" style=\"width:50px;height: 50px;text-align: center;\"></view>\r\n\t\t\t\t<view @click=\"btnScan\" style=\"flex:1;text-align: center;\">添加图书</view>\r\n\t\t\t\t<view @click=\"btnEnterEditing\" class=\"iconfont icon-apps\" style=\"width:50px;height: 50px;text-align: center;\"></view>\r\n\t\t\t</view>\r\n\t\t\t<view v-else style=\"background-color: #00aaff;width: 100%;height: 50px;border-radius: 25px;display: flex;line-height: 50px;color:#fff;justify-content: space-between;\">\r\n\t\t\t\t<view></view>\r\n\t\t\t\t<view @click=\"btnExitEditing\" style=\"flex:1;text-align: center;\">退出编辑模式</view>\r\n\t\t\t\t<view></view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</pubpage>\r\n</template>\r\n\r\n<script>\r\n\timport cloudApi from \"../../common/cloudApi.js\"\r\n\timport pubpage from \"../../components/pubpage.vue\"\r\n\timport pubshare from \"../../components/pubshare.vue\"\r\n\t\r\n\timport bookcell from \"../../components/pub-ui/bookcell.vue\"\r\n\t\r\n\texport default {\r\n\t\tcomponents:{\r\n\t\t\tpubpage,\r\n\t\t\tbookcell,\r\n\t\t\tpubshare\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitle:\"\",\r\n\t\t\t\tisEditing:false,\r\n\t\t\t\tshelfInfo:null,\r\n\t\t\t\tshelfid:null,\r\n\t\t\t\tcanloadmore:true,\r\n\t\t\t\tshowShareMenu:false,\r\n\t\t\t\tisBooksLen:false,\r\n\t\t\t\tbooks:[]\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tthis.shelfid = options.id;\r\n\t\t\tif(!this.shelfid)uni.navigateBack();\r\n\t\t\t\r\n\t\t\tthis.getShelfInfo();\r\n\t\t\tthis.requestBookList();\r\n\t\t},\r\n\t\tonReachBottom() {\r\n\t\t\tthis.requestBookList(this.books[this.books.length-1]._id);\r\n\t\t},\r\n\t\tonShareAppMessage() {\r\n\t\t\treturn {\r\n\t\t\t\ttitle: this.title,\r\n\t\t\t\tpath: '/pages/me/index?scene=sid='+this.shelfInfo._id\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tdrawPoster(){\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle:\"生成中\",\r\n\t\t\t\t\tmask:true\r\n\t\t\t\t});\r\n\t\t\t\tconst query = wx.createSelectorQuery()\r\n\t\t\t\tquery.select('#myPoster')\r\n\t\t\t\t\t .fields({ node: true, size: true })\r\n\t\t\t\t\t .exec(async (res) => {\r\n\t\t\t\t\t\tvar canvas = res[0].node\r\n\t\t\t\t\t\tvar ctx = canvas.getContext('2d')\r\n\t\t\t\t\r\n\t\t\t\t\t\tconst dpr = uni.getSystemInfoSync().pixelRatio\r\n\t\t\t\t\t\tcanvas.width = res[0].width * dpr\r\n\t\t\t\t\t\tcanvas.height = res[0].height * dpr\r\n\t\t\t\t\t\tctx.scale(dpr, dpr)\r\n\t\t\t\t\r\n\t\t\t\t\t\tctx.fillStyle = \"#ffffff\";\r\n\t\t\t\t\t\tctx.fillRect(0,30,350,750);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//ownerInfo\r\n\t\t\t\t\t\tctx.fillStyle='black';\r\n\t\t\t\t\t\tctx.fontSize=20;\r\n\t\t\t\t\t\t// console.log(this.shelfInfo.name)\r\n\t\t\t\t\t\tctx.fillText(\"用户名：\" + this.shelfInfo.ownerinfo.nickName, 70, 50);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tctx.fontSize=20\r\n\t\t\t\t\t\tctx.fillText(\"书房名：\" + this.shelfInfo.name, 70, 65);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tctx.fontSize=20\r\n\t\t\t\t\t\tctx.fillText(\"地址：\" + this.shelfInfo.address, 70, 80);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar image=canvas.createImage();\r\n\t\t\t\t\t\timage.onload=(res)=>{\r\n\t\t\t\t\t\t  ctx.drawImage(image, 10, 35,50,50);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\timage.src=this.shelfInfo.ownerinfo.avatarUrl;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//books\r\n\t\t\t\t\t\tvar bookLength = Math.min(this.books.length,9);\r\n\t\t\t\t\t\tvar bookIndex = 0;\r\n\t\t\t\t\t\tvar loadNextBookCover=()=>{\r\n\t\t\t\t\t\t\tvar bookItem = this.books[bookIndex];\r\n\t\t\t\t\t\t\tconsole.log(this.books)\r\n\t\t\t\t\t\t\tif(this.books.length<1){\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\tcontent: '无图书分享',\r\n\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\t\t\tsrc:bookItem.cover_url,\r\n\t\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\t\tvar image = canvas.createImage();\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\timage.onload=()=>{\r\n\t\t\t\t\t\t\t\t\t\tvar dx = Math.floor(bookIndex % 3) * (100+15)+10;\r\n\t\t\t\t\t\t\t\t\t\tvar dy = Math.floor(bookIndex / 3) * (150+15)+100;\r\n\t\t\t\t\t\t\t\t\t\tctx.drawImage(image, dx, dy,100,150);\r\n\t\t\t\t\t\t\t\t\t\t// 书名\r\n\t\t\t\t\t\t\t\t\t\tctx.fontSize=16\r\n\t\t\t\t\t\t\t\t\t\tctx.fillText(bookItem.title, dx+5, dy+165);\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif(bookIndex<bookLength-1){\r\n\t\t\t\t\t\t\t\t\t\t  bookIndex++;\r\n\t\t\t\t\t\t\t\t\t\t  loadNextBookCover();\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t  console.log(\"全部封面加载结束\");\r\n\t\t\t\t\t\t\t\t\t\t  uni.hideLoading();\r\n\t\t\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t\t\t  uni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\t\t\t\t\t  canvas:canvas,\r\n\t\t\t\t\t\t\t\t\t\t\t  success: (res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t  \tuni.previewImage({\r\n\t\t\t\t\t\t\t\t\t\t\t  \t\tcurrent:res.tempFilePath,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\turls:[res.tempFilePath]\r\n\t\t\t\t\t\t\t\t\t\t\t  \t})\r\n\t\t\t\t\t\t\t\t\t\t\t  },\r\n\t\t\t\t\t\t\t\t\t\t\t  fail: (err) => {\r\n\t\t\t\t\t\t\t\t\t\t\t  \tconsole.log(err);\r\n\t\t\t\t\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t\t\t\t\t  })\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\timage.src=res.path;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//wxacode\r\n\t\t\t\t\t\tconst wxacodeRes = await cloudApi.call({\r\n\t\t\t\t\t\t\tname:\"getwxacode\",\r\n\t\t\t\t\t\t\tdata:{\r\n\t\t\t\t\t\t\t\tscene:\"sid=\"+this.shelfInfo._id\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tconsole.log(wxacodeRes)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\twx.getFileSystemManager().writeFileSync(\r\n\t\t\t\t\t\t\t`${wx.env.USER_DATA_PATH}/mpcode.jpg`,\r\n\t\t\t\t\t\t\tuni.arrayBufferToBase64(wxacodeRes.result.data),\r\n\t\t\t\t\t\t\t\"base64\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\t\tsrc:`${wx.env.USER_DATA_PATH}/mpcode.jpg`,\r\n\t\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\t\tvar image=canvas.createImage();\r\n\t\t\t\t\t\t\t\timage.onload=(res)=>{\t\t\t\r\n\t\t\t\t\t\t\t\t  ctx.drawImage(image, 350-170, 750-170,160,160);\r\n\t\t\t\t\t\t\t\t  loadNextBookCover();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\timage.src=res.path;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonShareSelected(index){\r\n\t\t\t\tif(index==1){\r\n\t\t\t\t\tthis.drawPoster();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonShareDismiss(){\r\n\t\t\t\tthis.showShareMenu= false;\r\n\t\t\t},\r\n\t\t\tgetShelfInfo() {\r\n\t\t\t\tcloudApi.call({\r\n\t\t\t\t\tname:\"bookshelfs\",\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\taction:\"get\",\r\n\t\t\t\t\t\t_id:this.shelfid\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess:(res)=>{\r\n\t\t\t\t\t\tconsole.log(res.result);\r\n\t\t\t\t\t\tthis.shelfInfo = res.result;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\trequestBookList(start=0){\r\n\t\t\t\tif(start&&!this.canloadmore)return;\r\n\t\t\t\tcloudApi.call({\r\n\t\t\t\t\tname:\"books\",\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\taction:\"listbyshelf\",\r\n\t\t\t\t\t\tshelfid:this.shelfid,\r\n\t\t\t\t\t\tstart:start\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess:(res)=>{\r\n\t\t\t\t\t\tthis.canloadmore = res.result.length>=9;\r\n\t\t\t\t\t\tif(!start)this.books = res.result;\r\n\t\t\t\t\t\telse this.books = this.books.concat(res.result);\r\n\t\t\t\t\t\tif(this.books<1){\r\n\t\t\t\t\t\t\tthis.isBooksLen = true;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.isBooksLen = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// console.log('图书',this.books)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tbtnDeleteBook(e){\r\n\t\t\t\tconsole.log(e.currentTarget.dataset.id);\r\n\t\t\t\tuni.showActionSheet({\r\n\t\t\t\t\titemList:[\"置顶\",\"删除\"],\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tif(res.tapIndex==0){\r\n\t\t\t\t\t\t\tcloudApi.call({\r\n\t\t\t\t\t\t\t\tname:\"books\",\r\n\t\t\t\t\t\t\t\tdata:{\r\n\t\t\t\t\t\t\t\t\taction:\"movetop\",\r\n\t\t\t\t\t\t\t\t\tbookid:e.currentTarget.dataset.id\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tsuccess:(res)=>{\r\n\t\t\t\t\t\t\t\t\tthis.requestBookList();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}else if(res.tapIndex==1){\r\n\t\t\t\t\t\t\tcloudApi.call({\r\n\t\t\t\t\t\t\t\tname:\"books\",\r\n\t\t\t\t\t\t\t\tdata:{\r\n\t\t\t\t\t\t\t\t\taction:\"delete\",\r\n\t\t\t\t\t\t\t\t\tshelfid:this.shelfid,\r\n\t\t\t\t\t\t\t\t\tbookid:e.currentTarget.dataset.id\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tsuccess:(res)=>{\r\n\t\t\t\t\t\t\t\t\tthis.requestBookList();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tbtnExitEditing(){\r\n\t\t\t\tthis.isEditing = false;\r\n\t\t\t},\r\n\t\t\tbtnEnterEditing(){\r\n\t\t\t\tthis.isEditing = true;\r\n\t\t\t},\r\n\t\t\tbtnScan(){\r\n\t\t\t\tuni.scanCode({\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\tconst isbnres = await cloudApi.call({\r\n\t\t\t\t\t\t\tname:\"ISBNQuery\",\r\n\t\t\t\t\t\t\tdata:{\r\n\t\t\t\t\t\t\t\tisbn:res.result\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tawait cloudApi.call({\r\n\t\t\t\t\t\t\tname:\"books\",\r\n\t\t\t\t\t\t\tdata:{\r\n\t\t\t\t\t\t\t\taction:\"add\",\r\n\t\t\t\t\t\t\t\tshelfid:this.shelfid,\r\n\t\t\t\t\t\t\t\tisbnid:isbnres.result._id,\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.requestBookList();\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log('扫码失败',err);\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '扫码失败,请重新尝试',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\tpage\r\n\t{\r\n\t\tbackground-color: #fff;\r\n\t}\r\n\t.User_info{\r\n\t\twidth: auto;\r\n\t\tmargin-top: 30rpx;\r\n\t\tpadding-left: 30rpx;\r\n\t\tdisplay: flex;\r\n\t\t.User_avatarUrl{\r\n\t\t\twidth: 150rpx;\r\n\t\t\theight: 150rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t}\r\n\t\t.User_text{\r\n\t\t\tmargin-left: 20rpx;\r\n\t\t\t.nickName{\r\n\t\t\t\tmargin: 10rpx 0;\r\n\t\t\t}\r\n\t\t\ttext{\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>\r\n","import mod from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./bookshelf.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1656867034281\n      var cssReload = require(\"E:/HBuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}