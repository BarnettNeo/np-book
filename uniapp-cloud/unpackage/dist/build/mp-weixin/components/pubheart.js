(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/pubheart"],{1589:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=u(n("a34a")),o=u(n("9814")),a=u(n("d055")),i=n("26cb");function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return f(t)||d(t)||s(t)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){if(t){if("string"===typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function d(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function f(t){if(Array.isArray(t))return p(t)}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e,n,r,o,a,i){try{var u=t[a](i),c=u.value}catch(l){return void n(l)}u.done?e(c):Promise.resolve(c).then(r,o)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){h(a,r,o,i,u,"next",t)}function u(t){h(a,r,o,i,u,"throw",t)}i(void 0)}))}}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y={name:"pubheart",data:function(){return{options:{},action:"",where:{},field:"name,nickName,avatarUrl,totalbook,createtime,geopoint,totalheart,heart",heart:{loading:!1},dbData:[]}},computed:v(v({},(0,i.mapGetters)(["token"])),(0,i.mapState)(["userInfo"])),methods:v(v({},(0,i.mapMutations)(["setUserInfo"])),{},{btnEnter:function(e){var n=this;this.userInfo&&this.userInfo.avatarUrl?t.navigateTo({url:"../../pages/bookshelf/bookshelf?id="+e}):t.getUserProfile({desc:"信息给哥交出来",success:function(){var a=b(r.default.mark((function a(i){var u;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:u=v(v({},n.userInfo),i.userInfo),n.setUserInfo(u),o.default.updateUserInfo(u),t.navigateTo({url:"../../pages/bookshelf/bookshelf?id="+e});case 4:case"end":return r.stop()}}),a)})));function i(t){return a.apply(this,arguments)}return i}()})},onqueryload:function(t,e){var n=this;t.forEach((function(t){t.heart&&t.heart.find((function(e){n.userInfo&&n.userInfo._id==e.user_id&&(t.inverted=!0)}))})),this.dbData=[].concat(c(this.dbData),c(t)),console.log(this.dbData)},onqueryerror:function(t){console.log("onqueryerror",t)},updateHeart:function(e,n){var r=this;this.heart.loading||(t.hideLoading(),e?(this.heart.loading=!0,t.showModal({content:"确定取消喜欢吗?",success:function(t){t.confirm?(r.heart.loading=!0,a.default.call({name:"updateHeart",data:{action:"delete",token:r.token,_id:n},loading:!0,success:function(t){console.log(t),r.heart.loading=!1,r.updateHeartType(n,!1,-1)}})):r.heart.loading=!1}})):(console.log("点赞喜欢"),this.heart.loading=!0,a.default.call({name:"updateHeart",data:{action:"add",token:this.token,_id:n},loading:!0,success:function(t){console.log(t),r.heart.loading=!1,r.updateHeartType(n,!0,1)}})))},updateHeartType:function(t,e,n){console.log(t,e,n),this.dbData.find((function(r){if(r._id==t)return r.inverted=e,void(r.totalheart+=n)}))}})};e.default=y}).call(this,n("543d")["default"])},"24d7":function(t,e,n){"use strict";n.r(e);var r=n("2d81"),o=n("6d7d");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("aa14");var i,u=n("f0c5"),c=Object(u["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],i);e["default"]=c.exports},"2d81":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return r}));var r={unicloudDb:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-cli-shared/components/unicloud-db")]).then(n.bind(null,"960d"))},uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(n.bind(null,"fea7"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.$hasScopedSlotsParams("9cd38b3c-1")),r=n?t.$getScopedSlotsParams("9cd38b3c-1","default","error"):null,o=n&&r?t.$getScopedSlotsParams("9cd38b3c-1","default","error"):null;t.$mp.data=Object.assign({},{$root:{m0:n,m1:r,m2:o}})},a=[]},"6d7d":function(t,e,n){"use strict";n.r(e);var r=n("1589"),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e["default"]=o.a},aa14:function(t,e,n){"use strict";var r=n("fc02"),o=n.n(r);o.a},fc02:function(t,e,n){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/pubheart-create-component',
    {
        'components/pubheart-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("24d7"))
        })
    },
    [['components/pubheart-create-component']]
]);
